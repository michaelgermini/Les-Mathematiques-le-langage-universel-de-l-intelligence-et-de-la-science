# 15.4. Simulation et calcul haute performance

## Introduction : expérimenter avec des modèles

Lorsque les expériences réelles sont **trop coûteuses, trop lentes ou trop dangereuses**,
on se tourne vers la **simulation numérique** : on remplace le système physique
par un modèle mathématique (souvent des équations différentielles), puis on le résout
sur ordinateur.  

Pour des phénomènes réalistes (climat, turbulence, matériaux, astrophysique), les modèles
impliquent des millions ou des milliards de variables : d’où le besoin de **calcul haute performance (HPC)**.

## Méthodes numériques pour les équations aux dérivées partielles

### Principe général

Beaucoup de phénomènes continus sont décrits par des **équations aux dérivées partielles** (EDP) :

- **Équation de la chaleur** : diffusion de température.  
- **Équation des ondes** : propagation de signaux mécaniques ou électromagnétiques.  
- **Navier–Stokes** : écoulement des fluides.  

On ne peut pas résoudre ces équations analytiquement dans la plupart des cas ;  
on les approxime numériquement en remplaçant le continu par un **maillage discret**.

### Méthode des éléments finis (FEM)

- On découpe le domaine (une aile d’avion, une pièce mécanique) en petits éléments (triangles, tétraèdres).  
- On approxime la solution par des fonctions simples sur chaque élément (polynômes).  
- On obtient un grand système linéaire **A x = b** à résoudre.

La FEM est très générale et gère bien les géométries complexes, mais conduit à
de très grandes matrices clairsemées — idéales pour le HPC.

### Volumes finis et différences finies

- **Volumes finis** : on applique les lois de conservation (masse, énergie, quantité de mouvement)
  sur des petites cellules de contrôle. Très utilisée en mécanique des fluides (CFD).  
- **Différences finies** : on approxime les dérivées par des différences sur un maillage régulier
  (grille). Simple et efficace pour des géométries simples.

### Méthodes particulaires

- **SPH (Smoothed Particle Hydrodynamics)** : les fluides sont représentés par des particules.  
- **DEM (Discrete Element Method)** : simulation de grains, roches, matériaux granulaires.

Ces méthodes sont très adaptées à des mouvements libres, collisions et grandes déformations,
et se parallélisent bien sur GPU.

## Calcul haute performance (HPC)

### Parallélisation des calculs

Les grands systèmes linéaires ou non linéaires issus des méthodes numériques nécessitent
des **millions de pas de calcul**. On les répartit sur :

- **Supercalculateurs** : milliers de cœurs CPU interconnectés.  
- **Clusters GPU** : calcul massivement parallèle sur cartes graphiques.  
- **Cloud HPC** : ressources allouées dynamiquement selon la charge.

Les modèles de programmation parallèles incluent :

- **MPI (Message Passing Interface)** : communications explicites entre processus (parallélisme distribué).  
- **OpenMP** : parallélisme partagé sur multi‑cœurs (threads).  
- **CUDA / OpenCL** : programmation bas niveau de GPU.

### Scalabilité

Un code est dit **scalable** s’il accélère bien quand on augmente le nombre de processeurs :

- **Scalabilité forte** : temps ↓ quand processeurs ↑ pour un problème fixe.  
- **Scalabilité faible** : on agrandit le problème en même temps que les ressources.

Les lois d’Amdahl et de Gustafson donnent des limites théoriques à cette accélération,
en fonction de la partie séquentielle incompressible du code.

## Applications de la simulation numérique

### Mécanique des fluides numérique (CFD)

- **Aéronautique** : forme des ailes, turbulence, bruit.  
- **Automobile** : aérodynamique, refroidissement moteur.  
- **Météorologie** : prévision du temps, modèles climatiques.

Les équations de Navier–Stokes sont résolues sur des maillages tridimensionnels massifs,
avec des schémas explicites ou implicites, stabilisation numérique, etc.

### Mécanique des solides et ingénierie

- **Crash tests virtuels** : impact de véhicules, sécurité passive.  
- **Mécanique des structures** : ponts, bâtiments, turbines.  
- **Conception optimale** : optimisation topologique de pièces.

La FEM, couplée à l’optimisation, permet de concevoir des structures plus légères
et plus résistantes qu’avec des méthodes purement empiriques.

### Chimie quantique et physique des matériaux

- **DFT (Density Functional Theory)** : structure électronique des matériaux.  
- **Simulations de dynamique moléculaire** : protéines, membranes, matériaux complexes.  
- **Conception de médicaments** : docking, exploration de l’espace de conformations.

Ces simulations nécessitent des calculs linéaires algébriques de grande taille,
des diagonalisation de matrices, des méthodes itératives, etc.

## Vers le jumeau numérique

La convergence entre **modèles physiques**, **données expérimentales** et **IA**
donne naissance au concept de **jumeau numérique** :

- copie virtuelle d’un système réel (usine, ville, avion)  
- mise à jour en temps réel par les données capteurs  
- utilisée pour la maintenance prédictive, l’optimisation, la formation.

Les mathématiques assurent la cohérence entre la simulation, les données et
les algorithmes d’apprentissage — condition pour que ces jumeaux soient fiables
et utiles à la décision.
