# 11.1. Modèles génératifs (diffusion, VAEs)

## Variational Autoencoders (VAE)

### Principe fondamental
- **Encoder** : q(z|x) ≈ p(z|x) approximation de la postérieure
- **Decoder** : p(x|z) modèle génératif
- **ELBO** : Evidence Lower Bound = E_q[log p(x|z)] - KL(q(z|x)||p(z))

### Reparameterization trick
z = μ + σ ⊙ ε, où ε ~ N(0,I)

- **Différentiable** : gradient à travers l'échantillonnage
- **Variance apprise** : σ(x) > 0 pour chaque entrée
- **Modèle latent** : distribution apprise par le réseau

### Applications des VAE
- **Génération** : échantillonnage p(z) puis p(x|z)
- **Interpolation** : chemin continu dans l'espace latent
- **Compression** : encoder comme code compressé

## Modèles de diffusion

### Forward process (diffusion)
q(x_t | x_{t-1}) = N(√(1-β_t) x_{t-1}, β_t I)

- **Bruit additif** : variance β_t croissante
- **Schedule** : β_1 < β_2 < ... < β_T
- **Limite** : x_T ≈ N(0,I) quand T → ∞

### Reverse process (débruitage)
p_θ(x_{t-1} | x_t) = N(μ_θ(x_t, t), Σ_θ(x_t, t))

- **Apprentissage** : réseau θ prédit les paramètres
- **Objectif** : minimiser différence avec forward process
- **Génération** : échantillonnage inverse de T à 0

### Score-based generative models
- **Score function** : ∇_x log p(x)
- **Langevin dynamics** : x ← x + (σ²/2) ∇ log p(x) + σε
- **Denoising score matching** : apprentissage du score par diffusion

## Autres modèles génératifs

### GANs (Generative Adversarial Networks)
- **Generator** : G(z) génère des échantillons
- **Discriminator** : D(x) distingue vrai de faux
- **Minimax** : min_G max_D E[log D(x)] + E[log(1-D(G(z)))]

### Normalizing Flows
- **Transformation bijective** : z = f(x)
- **Jacobien** : log p_x = log p_z - log |det df/dx|
- **Maximum de vraisemblance** : optimisation directe

### Energy-based models
- **Énergie** : E(x) définit p(x) ∝ exp(-E(x))
- **Apprentissage** : contrastive divergence
- **Sampling** : MCMC, Langevin dynamics

## Évaluation des modèles génératifs

### Métriques
- **Inception Score (IS)** : qualité et diversité
- **FID** : Fréchet Inception Distance
- **Precision/Recall** : couverture et fidélité

### Défis
- **Mode collapse** : GANs génèrent peu de variété
- **Blur** : VAEs trop lisses
- **Computation** : diffusion lente à l'inférence
