# 7.3. Cryptographie

## Introduction : l'art de protéger l'information

La cryptographie est la science de la communication sécurisée en présence d'adversaires. Elle vise à garantir quatre propriétés fondamentales :

- **Confidentialité** : seul le destinataire légitime peut lire le message
- **Intégrité** : le message n'a pas été altéré
- **Authenticité** : le message provient bien de l'expéditeur annoncé
- **Non-répudiation** : l'expéditeur ne peut nier avoir envoyé le message

Ces objectifs reposent sur des **problèmes mathématiques difficiles** : factorisation, logarithme discret, problèmes sur les réseaux euclidiens.

---

## 1. Cryptographie symétrique

Dans la cryptographie symétrique, la même clé sert au chiffrement et au déchiffrement.

### 1.1 Chiffrement par blocs

#### Principe
- Découpe le message en blocs de taille fixe (64, 128, 256 bits)
- Applique une transformation réversible paramétrée par la clé
- Combine substitutions et permutations (confusion et diffusion de Shannon)

#### Algorithmes majeurs

| Algorithme | Taille bloc | Taille clé | Statut |
|------------|-------------|------------|--------|
| **DES** | 64 bits | 56 bits | Obsolète (cassé) |
| **3DES** | 64 bits | 112/168 bits | Déprécié |
| **AES** | 128 bits | 128/192/256 bits | Standard actuel |
| **Blowfish** | 64 bits | 32-448 bits | Remplacé par Twofish |

#### AES (Advanced Encryption Standard)
- Sélectionné par le NIST en 2001 (algorithme Rijndael)
- Structure : 10/12/14 tours selon la taille de clé
- Opérations : SubBytes, ShiftRows, MixColumns, AddRoundKey
- Résistant aux attaques connues avec clés de 128+ bits

#### Modes de chiffrement

| Mode | Description | Propriétés |
|------|-------------|------------|
| **ECB** | Chaque bloc indépendant | À éviter (motifs visibles) |
| **CBC** | Chaînage avec XOR du bloc précédent | Diffusion, IV requis |
| **CTR** | Compteur chiffré puis XOR | Parallélisable |
| **GCM** | CTR + authentification | Chiffrement authentifié |

### 1.2 Chiffrement par flot

#### Principe
- Génère un flux pseudo-aléatoire (keystream) à partir de la clé
- XOR avec le texte clair : C = P ⊕ K

#### Algorithmes
- **RC4** : historique, vulnérabilités connues, déprécié
- **ChaCha20** : moderne, rapide, sécurisé
- **Salsa20** : prédécesseur de ChaCha20

#### ChaCha20-Poly1305
- ChaCha20 pour le chiffrement
- Poly1305 pour l'authentification (MAC)
- Utilisé dans TLS 1.3, WireGuard, Signal

---

## 2. Cryptographie asymétrique

Utilise une paire de clés : publique (chiffrement) et privée (déchiffrement).

### 2.1 RSA (Rivest-Shamir-Adleman)

#### Fondement mathématique
Difficulté de la **factorisation** de grands entiers.

#### Génération des clés
1. Choisir deux grands premiers p et q
2. Calculer n = p × q et φ(n) = (p-1)(q-1)
3. Choisir e tel que pgcd(e, φ(n)) = 1 (typiquement e = 65537)
4. Calculer d = e⁻¹ mod φ(n)
5. Clé publique : (n, e), clé privée : d

#### Opérations
- **Chiffrement** : c = mᵉ mod n
- **Déchiffrement** : m = cᵈ mod n
- **Signature** : s = mᵈ mod n
- **Vérification** : m = sᵉ mod n

#### Sécurité
- Clés de 2048 bits minimum (4096 recommandé pour le long terme)
- Padding obligatoire : OAEP pour chiffrement, PSS pour signature
- RSA brut est vulnérable à de nombreuses attaques

### 2.2 Cryptographie sur courbes elliptiques (ECC)

#### Fondement mathématique
Difficulté du **logarithme discret** sur les courbes elliptiques.

#### Courbe elliptique
Ensemble des points (x, y) satisfaisant :
```
y² = x³ + ax + b (mod p)
```
avec 4a³ + 27b² ≠ 0, plus un point à l'infini O.

#### Loi de groupe
- Addition de points : construction géométrique
- Multiplication scalaire : k·P = P + P + ... + P (k fois)
- Problème difficile : trouver k connaissant P et Q = k·P

#### Algorithmes
- **ECDH** : échange de clés Diffie-Hellman sur courbes
- **ECDSA** : signature numérique
- **Ed25519** : signature moderne (courbe Edwards)

#### Avantages de l'ECC
| Niveau de sécurité | RSA | ECC |
|--------------------|-----|-----|
| 80 bits | 1024 bits | 160 bits |
| 128 bits | 3072 bits | 256 bits |
| 256 bits | 15360 bits | 512 bits |

Clés plus courtes = calculs plus rapides, idéal pour mobile/embarqué.

---

## 3. Fonctions de hachage cryptographiques

### 3.1 Propriétés requises

Une fonction de hachage H : {0,1}* → {0,1}ⁿ doit satisfaire :

| Propriété | Définition | Difficulté |
|-----------|------------|------------|
| **Préimage** | Trouver m tel que H(m) = h | 2ⁿ opérations |
| **Seconde préimage** | Trouver m' ≠ m tel que H(m') = H(m) | 2ⁿ opérations |
| **Collision** | Trouver m ≠ m' tel que H(m) = H(m') | 2^(n/2) (paradoxe anniversaire) |
| **Effet avalanche** | Petit changement → sortie totalement différente | - |

### 3.2 Algorithmes

#### Famille SHA-2
- **SHA-256** : 256 bits, standard actuel
- **SHA-384, SHA-512** : variantes plus longues
- Construction Merkle-Damgård

#### SHA-3 (Keccak)
- Standard NIST 2015
- Construction éponge (différente de Merkle-Damgård)
- Résistant aux attaques par extension de longueur

#### BLAKE2 / BLAKE3
- Plus rapide que SHA-2 et SHA-3
- Sécurité comparable
- BLAKE3 : parallélisable, très performant

### 3.3 Applications

- **Intégrité** : vérification de fichiers (checksums)
- **Mots de passe** : stockage sécurisé (avec sel et itérations)
- **Signatures** : hachage du message avant signature
- **Blockchain** : chaînage des blocs, preuve de travail
- **Déduplication** : identification de contenus identiques

---

## 4. Protocoles cryptographiques

### 4.1 Échange de clés

#### Diffie-Hellman
Permet à deux parties d'établir un secret partagé sur un canal public.

```
1. Alice et Bob conviennent de p (premier) et g (générateur)
2. Alice choisit a secret, envoie A = g^a mod p
3. Bob choisit b secret, envoie B = g^b mod p
4. Secret partagé : K = B^a = A^b = g^(ab) mod p
```

Sécurité basée sur le problème du logarithme discret.

#### ECDH
Version sur courbes elliptiques, clés plus courtes.

### 4.2 Signatures numériques

#### DSA / ECDSA
- Basé sur le logarithme discret
- Signature : (r, s) calculés avec clé privée et aléa
- Vérification : équation impliquant clé publique

#### Ed25519
- Courbe Edwards (Edwards25519)
- Signature déterministe (pas d'aléa)
- Rapide, compact, largement déployé (SSH, Signal, Tor)

### 4.3 Certificats et PKI

#### Infrastructure à clé publique
- **Certificat X.509** : lie identité et clé publique
- **Autorité de certification (CA)** : émet et signe les certificats
- **Chaîne de confiance** : CA racine → CA intermédiaire → certificat final

#### TLS (Transport Layer Security)
1. **Handshake** : échange de clés, authentification
2. **Record** : chiffrement symétrique des données
3. **Alert** : gestion des erreurs

---

## 5. Cryptographie post-quantique

### 5.1 Menace quantique

#### Algorithme de Shor
- Factorise en temps polynomial sur ordinateur quantique
- **Conséquence** : RSA et ECC cassés

#### Algorithme de Grover
- Recherche en O(√N) au lieu de O(N)
- **Conséquence** : sécurité des clés symétriques divisée par 2
- Solution : doubler la taille des clés (AES-256)

### 5.2 Nouvelles familles

Le NIST a standardisé (2024) de nouveaux algorithmes :

#### Basés sur les réseaux (lattices)
- **ML-KEM (Kyber)** : encapsulation de clé
- **ML-DSA (Dilithium)** : signature
- Problèmes : LWE (Learning With Errors), Module-LWE

#### Basés sur le hachage
- **SLH-DSA (SPHINCS+)** : signature sans état
- Sécurité basée uniquement sur les fonctions de hachage

#### Basés sur les codes
- **Problème de décodage** de codes linéaires aléatoires
- Classic McEliece (clés très grandes)

### 5.3 Transition

- **Crypto-agilité** : systèmes capables de changer d'algorithme
- **Hybride** : combiner algorithmes classiques et post-quantiques
- **Harvest now, decrypt later** : urgence de la transition

---

## 6. Bonnes pratiques

### 6.1 Principes de Kerckhoffs

1. La sécurité doit reposer sur le secret de la clé, pas de l'algorithme
2. Utiliser des algorithmes publics, éprouvés, standardisés
3. Ne jamais implémenter soi-même (utiliser des bibliothèques auditées)

### 6.2 Gestion des clés

- **Génération** : source d'aléa cryptographique (/dev/urandom, CSPRNG)
- **Stockage** : HSM, coffres-forts, chiffrement des clés au repos
- **Rotation** : renouveler régulièrement les clés
- **Destruction** : effacement sécurisé en fin de vie

### 6.3 Erreurs courantes à éviter

- ECB mode (motifs visibles)
- IV/nonce réutilisés
- Padding oracle (CBC mal implémenté)
- Timing attacks (comparaisons non constantes)
- Aléa faible ou prédictible

---

## Conclusion

La cryptographie moderne est un édifice mathématique sophistiqué qui protège nos communications, nos données et nos identités numériques. Elle repose sur :

1. **Des problèmes mathématiques difficiles** (factorisation, logarithme discret, réseaux)
2. **Des protocoles rigoureusement conçus** (prouvés sécurisés sous hypothèses)
3. **Des implémentations soignées** (résistantes aux attaques par canaux auxiliaires)

Face à la menace quantique, le domaine évolue rapidement vers de nouvelles primitives, illustrant la nature dynamique de cette discipline à l'intersection des mathématiques et de l'informatique.
